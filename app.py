import streamlit as st
import random

# --- ãƒšãƒ¼ã‚¸è¨­å®š ---
st.set_page_config(
    page_title="UPRãƒã‚¹ã‚¿ãƒ¼ã‚¯ã‚¤ã‚º", 
    page_icon="ğŸšš",
    layout="wide"
)

# --- 1. åŸºæœ¬å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ ---
# ã“ã“ã«ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’å…ƒã«ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒè‡ªå‹•ã§300å•ä»¥ä¸Šã«æ‹¡å¼µã—ã¾ã™ã€‚
# è¡¨è¨˜ã¯ã™ã¹ã¦ã€ŒUPRã€ã«çµ±ä¸€ã—ã¦ã„ã¾ã™ã€‚

BASE_QUESTIONS = [
    # --- åŸºæœ¬æƒ…å ± ---
    {"c": "åŸºæœ¬", "q": "UPRæ ªå¼ä¼šç¤¾ã®ç¾åœ¨ã®ä»£è¡¨å–ç· å½¹ç¤¾é•·ã¯ï¼Ÿ", "a": "é…’ç”° ç¾©çŸ¢", "o": ["é…’ç”° ä¸‰ç”·", "é…’ç”° ç¾©çŸ¢", "çŸ³æ‘ æµ©", "å¤§åº­ æ­£ä¿¡"], "e": "é…’ç”°ç¾©çŸ¢æ°ãŒä»£è¡¨å–ç· å½¹ç¤¾é•·ã§ã™ã€‚"},
    {"c": "åŸºæœ¬", "q": "UPRã®å‰µæ¥­ã®åœ°ã¯ï¼Ÿ", "a": "å±±å£çœŒå®‡éƒ¨å¸‚", "o": ["æ±äº¬éƒ½åƒä»£ç”°åŒº", "å¤§é˜ªåºœå¤§é˜ªå¸‚", "å±±å£çœŒå®‡éƒ¨å¸‚", "ç¦å²¡çœŒç¦å²¡å¸‚"], "e": "1979å¹´ã«å±±å£çœŒå®‡éƒ¨å¸‚ã§è¨­ç«‹ã•ã‚Œã¾ã—ãŸã€‚"},
    {"c": "åŸºæœ¬", "q": "UPRã®ä¸»åŠ›äº‹æ¥­ã¯ï¼Ÿ", "a": "ãƒ‘ãƒ¬ãƒƒãƒˆãƒ»ç‰©æµæ©Ÿå™¨ã®ãƒ¬ãƒ³ã‚¿ãƒ«", "o": ["ã‚¢ã‚·ã‚¹ãƒˆã‚¹ãƒ¼ãƒ„è£½é€ ", "ã‚«ãƒ¼ã‚·ã‚§ã‚¢ãƒªãƒ³ã‚°", "ãƒ‘ãƒ¬ãƒƒãƒˆãƒ»ç‰©æµæ©Ÿå™¨ã®ãƒ¬ãƒ³ã‚¿ãƒ«", "å€‰åº«é‹å–¶"], "e": "å£²ä¸Šã®ç´„9å‰²ã‚’å ã‚ã‚‹ä¸»åŠ›äº‹æ¥­ã§ã™ã€‚"},
    {"c": "åŸºæœ¬", "q": "UPRã®è¨¼åˆ¸ã‚³ãƒ¼ãƒ‰ã¯ï¼Ÿ", "a": "7065", "o": ["7065", "9090", "2323", "4649"], "e": "æ±è¨¼ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰å¸‚å ´ã§ã®ã‚³ãƒ¼ãƒ‰ã¯7065ã§ã™ã€‚"},
    {"c": "åŸºæœ¬", "q": "UPRã®ã‚³ãƒ¼ãƒãƒ¬ãƒ¼ãƒˆã‚¹ãƒ­ãƒ¼ã‚¬ãƒ³ã€Œâ—‹â—‹ Sharing Supporterã€ã€‚â—‹â—‹ã¯ï¼Ÿ", "a": "Social", "o": ["Value", "Social", "Logistics", "Future"], "e": "ã€Œç¤¾ä¼šã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚’ã‚·ã‚§ã‚¢ã™ã‚‹UPRã€ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã€‚"},
    {"c": "åŸºæœ¬", "q": "UPRã®æ±ºç®—æœˆã¯ï¼Ÿ", "a": "8æœˆ", "o": ["3æœˆ", "8æœˆ", "9æœˆ", "12æœˆ"], "e": "äº‹æ¥­å¹´åº¦ã®æœ«æ—¥ã¯æ¯å¹´8æœˆ31æ—¥ã§ã™ã€‚"},
    {"c": "åŸºæœ¬", "q": "UPRã®æ±äº¬æœ¬ç¤¾ã®æ‰€åœ¨åœ°ã¯ï¼Ÿ", "a": "åƒä»£ç”°åŒº", "o": ["æ¸¯åŒº", "åƒä»£ç”°åŒº", "æ–°å®¿åŒº", "å“å·åŒº"], "e": "å†…å¹¸ç”ºæ±æ€¥ãƒ“ãƒ«ï¼ˆåƒä»£ç”°åŒºï¼‰ã«ã‚ã‚Šã¾ã™ã€‚"},
    {"c": "åŸºæœ¬", "q": "UPRã®å‰µæ¥­å¹´ã¯ï¼Ÿ", "a": "1979å¹´", "o": ["1950å¹´", "1979å¹´", "1988å¹´", "2007å¹´"], "e": "ã‚¦ãƒ™ãƒ‘ãƒ¬ãƒƒãƒˆæ ªå¼ä¼šç¤¾ã¨ã—ã¦1979å¹´ã«è¨­ç«‹ã•ã‚Œã¾ã—ãŸã€‚"},
    {"c": "åŸºæœ¬", "q": "UPRä¿æœ‰ã®ãƒ‘ãƒ¬ãƒƒãƒˆæšæ•°ã¯ç´„ä½•æšï¼Ÿ", "a": "ç´„510ä¸‡æš", "o": ["ç´„100ä¸‡æš", "ç´„510ä¸‡æš", "ç´„300ä¸‡æš", "ç´„1000ä¸‡æš"], "e": "æ¥­ç•Œãƒˆãƒƒãƒ—ã‚¯ãƒ©ã‚¹ã®ä¿æœ‰æšæ•°ã‚’èª‡ã‚Šã¾ã™ã€‚"},
    {"c": "åŸºæœ¬", "q": "UPRã¸ã®ç¤¾åå¤‰æ›´ã¯ä½•å¹´ï¼Ÿ", "a": "2007å¹´", "o": ["2000å¹´", "2007å¹´", "2015å¹´", "2019å¹´"], "e": "2007å¹´ã«ç¾åœ¨ã®ç¤¾åã«å¤‰æ›´ã•ã‚Œã¾ã—ãŸã€‚"},

    # --- ã‚µãƒ¼ãƒ“ã‚¹ãƒ»å•†å“ ---
    {"c": "ã‚µãƒ¼ãƒ“ã‚¹", "q": "ç‰©æµç¾å ´ã®è² æ‹…è»½æ¸›ã‚’ç›®æŒ‡ã™UPRã®è£…ç€å‹æ©Ÿå™¨ã¯ï¼Ÿ", "a": "ã‚¢ã‚·ã‚¹ãƒˆã‚¹ãƒ¼ãƒ„", "o": ["ãƒ‘ãƒ¯ãƒ¼ãƒ‰ã‚¹ãƒ¼ãƒ„", "ã‚¢ã‚·ã‚¹ãƒˆã‚¹ãƒ¼ãƒ„", "ãƒ­ãƒœãƒƒãƒˆã‚¢ãƒ¼ãƒ ", "å¼·åŒ–å¤–éª¨æ ¼"], "e": "ã€Œã‚µãƒãƒ¼ãƒˆã‚¸ãƒ£ã‚±ãƒƒãƒˆã€ã‚·ãƒªãƒ¼ã‚ºãªã©ã‚’å±•é–‹ã—ã¦ã„ã¾ã™ã€‚"},
    {"c": "ã‚µãƒ¼ãƒ“ã‚¹", "q": "ä½ç½®ãƒ»æ¸©æ¹¿åº¦ã‚’é éš”ç›£è¦–ã§ãã‚‹ç‰©æµIoTã‚µãƒ¼ãƒ“ã‚¹ã¯ï¼Ÿ", "a": "ãªã‚“ã¤ã„", "o": ["ã¿ã¾ã‚‚ã‚Šãã‚“", "ãªã‚“ã¤ã„", "ã©ã“ã§ã‚‚ã‚µãƒ¼ãƒ", "ãƒ­ã‚¸ãƒ“ã‚¸ãƒ§ãƒ³"], "e": "ã€Œãªã‚“ã§ã‚‚è¿½è·¡ã€ã®ç•¥ç§°ã§ã™ã€‚"},
    {"c": "ã‚µãƒ¼ãƒ“ã‚¹", "q": "RFIDã‚¿ã‚°æ­è¼‰ã®åœ¨åº«ç®¡ç†ãƒ‘ãƒ¬ãƒƒãƒˆã®åç§°ã¯ï¼Ÿ", "a": "ã‚¹ãƒãƒ¼ãƒˆãƒ‘ãƒ¬ãƒƒãƒˆ", "o": ["ãƒ‡ã‚¸ãƒ‘ãƒ¬ãƒƒãƒˆ", "ã‚¹ãƒãƒ¼ãƒˆãƒ‘ãƒ¬ãƒƒãƒˆ", "AIãƒ‘ãƒ¬ãƒƒãƒˆ", "ã‚µã‚¤ãƒãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ"], "e": "æ£šå¸ã—ã®è‡ªå‹•åŒ–ãªã©ã‚’å®Ÿç¾ã™ã‚‹DXè£½å“ã§ã™ã€‚"},
    {"c": "ã‚µãƒ¼ãƒ“ã‚¹", "q": "è¡›ç”Ÿç®¡ç†HACCPå¯¾å¿œã®IoTãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ï¼Ÿ", "a": "UPR HACCP", "o": ["Clean Log", "UPR HACCP", "Food Keeper", "è¡›ç”Ÿãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼"], "e": "æ¸©åº¦ç®¡ç†ã¨è¨˜éŒ²ã‚’è‡ªå‹•åŒ–ã™ã‚‹ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚"},
    {"c": "ã‚µãƒ¼ãƒ“ã‚¹", "q": "UPRã®ã‚«ãƒ¼ã‚·ã‚§ã‚¢ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã«ãŠã‘ã‚‹éµç®¡ç†BOXã¯ï¼Ÿ", "a": "ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ãƒœãƒƒã‚¯ã‚¹", "o": ["ã‚­ãƒ¼ã‚­ãƒ¼ãƒ‘ãƒ¼", "ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ãƒœãƒƒã‚¯ã‚¹", "ãƒ­ãƒƒã‚¯ãƒã‚¹ã‚¿ãƒ¼", "ã‚ªãƒ¼ãƒ—ãƒ³ã‚»ã‚µãƒŸ"], "e": "éå¯¾é¢ã§ã®éµã®å—ã‘æ¸¡ã—ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚"},
    {"c": "ã‚µãƒ¼ãƒ“ã‚¹", "q": "ã‚¹ãƒãƒ›ã§ãƒ‘ãƒ¬ãƒƒãƒˆæšæ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹ã‚¢ãƒ—ãƒªã¯ï¼Ÿ", "a": "ãƒ‘ãƒ¬ãƒƒãƒˆãƒ•ã‚¡ã‚¤ãƒ³ãƒ€ãƒ¼", "o": ["ãƒ‘ãƒ¬ãƒƒãƒˆã‚«ã‚¦ãƒ³ã‚¿ãƒ¼", "æ•°ãˆãƒ«ãƒ³", "ãƒ‘ãƒ¬ãƒƒãƒˆãƒ•ã‚¡ã‚¤ãƒ³ãƒ€ãƒ¼", "AIãƒã‚§ãƒƒã‚«ãƒ¼"], "e": "ç”»åƒèªè­˜AIã‚’æ´»ç”¨ã—ãŸã‚¢ãƒ—ãƒªã§ã™ã€‚"},
    {"c": "ã‚µãƒ¼ãƒ“ã‚¹", "q": "å›½éš›è¼¸é€ã®è¿½è·¡ã«ç‰¹åŒ–ã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã¯ï¼Ÿ", "a": "ãƒ¯ãƒ¼ãƒ«ãƒ‰ã‚­ãƒ¼ãƒ‘ãƒ¼", "o": ["ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¢ã‚¤", "ãƒ¯ãƒ¼ãƒ«ãƒ‰ã‚­ãƒ¼ãƒ‘ãƒ¼", "æµ·å¤–ãªã‚“ã¤ã„", "ã‚ªãƒ¼ã‚·ãƒ£ãƒ³ãƒ“ãƒ¥ãƒ¼"], "e": "å›½ã‚’ã¾ãŸãè¼¸é€ã®ä½ç½®ãƒ»çŠ¶æ…‹ç›£è¦–ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚"},
    {"c": "ã‚µãƒ¼ãƒ“ã‚¹", "q": "ç‰›ã®ç™ºæƒ…æ¤œçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã®åç§°ã¯ï¼Ÿ", "a": "ç‰›æ¸©æµ", "o": ["ãƒ¢ãƒ¼ãƒ¢ãƒ¼ã‚µãƒ¼ãƒ", "ç‰›æ¸©æµ", "ã‚­ãƒ£ãƒˆãƒ«ã‚³ãƒ¼ãƒ«", "ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚©ãƒƒãƒ"], "e": "ã€Œã†ã—ãŠã‚“ã‘ã„ã€ã¨èª­ã¿ã€ç•œç”£è¾²å®¶ã‚’æ”¯æ´ã—ã¾ã™ã€‚"},
    {"c": "ã‚µãƒ¼ãƒ“ã‚¹", "q": "UPRã®ã‚¢ã‚·ã‚¹ãƒˆã‚¹ãƒ¼ãƒ„ã€Œã‚µãƒãƒ¼ãƒˆã‚¸ãƒ£ã‚±ãƒƒãƒˆã€ã®ä¸»ãªæ©Ÿèƒ½ã¯ï¼Ÿ", "a": "è…°ã®è² æ‹…è»½æ¸›", "o": ["æ¡åŠ›ã®å¼·åŒ–", "è„šåŠ›ã®å¼·åŒ–", "è…°ã®è² æ‹…è»½æ¸›", "è¦–åŠ›ã®è£œæ­£"], "e": "è·å½¹ä½œæ¥­æ™‚ã®è…°ã¸ã®è² è·ã‚’è»½æ¸›ã—ã¾ã™ã€‚"},
    {"c": "ã‚µãƒ¼ãƒ“ã‚¹", "q": "ãƒ‘ãƒ¬ãƒƒãƒˆãƒ¬ãƒ³ã‚¿ãƒ«ã®ä¿ç®¡ãƒ»æ•´å‚™æ‹ ç‚¹ã®å‘¼ã³åã¯ï¼Ÿ", "a": "ãƒ‡ãƒ", "o": ["ã‚¹ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³", "ãƒ™ãƒ¼ã‚¹", "ãƒ‡ãƒ", "ãƒãƒ–"], "e": "å…¨å›½ã«ç´„200ã‚«æ‰€ã®ãƒ‡ãƒãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒã‚ã‚Šã¾ã™ã€‚"},

    # --- ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ»æ­´å²ãƒ»IR ---
    {"c": "ã‚°ãƒ­ãƒ¼ãƒãƒ«", "q": "UPRãŒæœ€åˆã«æµ·å¤–é€²å‡ºã—ãŸå›½ã¯ï¼Ÿ", "a": "ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«", "o": ["ã‚¿ã‚¤", "ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«", "ãƒãƒ¬ãƒ¼ã‚·ã‚¢", "ãƒ™ãƒˆãƒŠãƒ "], "e": "2011å¹´ã«ç¾åœ°æ³•äººã‚’è¨­ç«‹ã—ã¾ã—ãŸã€‚"},
    {"c": "ã‚°ãƒ­ãƒ¼ãƒãƒ«", "q": "ã‚¿ã‚¤ã®ç¾åœ°æ³•äººåã¯ï¼Ÿ", "a": "UPR (Thailand) Co.,Ltd.", "o": ["UPR Siam", "UPR (Thailand) Co.,Ltd.", "Thai Palette", "UPR Bangkok"], "e": "2014å¹´ã«è¨­ç«‹ã•ã‚Œã¾ã—ãŸã€‚"},
    {"c": "æ­´å²", "q": "å‰µæ¥­å®¶ã§ã‚ã‚‹é…’ç”°å®¶ã®åˆä»£ç¤¾é•·ã¯ï¼Ÿ", "a": "é…’ç”° ä¸‰ç”·", "o": ["é…’ç”° ç¾©çŸ¢", "é…’ç”° ä¸‰ç”·", "é…’ç”° å¥æ²»", "é…’ç”° å¤ªéƒ"], "e": "1979å¹´ã®è¨­ç«‹æ™‚ã«å°±ä»»ã—ã¾ã—ãŸã€‚"},
    {"c": "IR", "q": "UPRãŒä¸Šå ´ã—ãŸã®ã¯è¥¿æš¦ä½•å¹´ï¼Ÿ", "a": "2019å¹´", "o": ["2015å¹´", "2019å¹´", "2021å¹´", "2000å¹´"], "e": "2019å¹´ã«æ±è¨¼äºŒéƒ¨ã«ä¸Šå ´ã—ã¾ã—ãŸã€‚"},
    {"c": "CSR", "q": "ãƒ‘ãƒ¬ãƒƒãƒˆãƒ—ãƒ¼ãƒ«ã‚·ã‚¹ãƒ†ãƒ ãŒå‰Šæ¸›ã«è²¢çŒ®ã™ã‚‹ã‚‚ã®ã¯ï¼Ÿ", "a": "CO2æ’å‡ºé‡ï¼ˆç©ºè·èµ°è¡Œï¼‰", "o": ["å€‰åº«ã®é›»æ°—ä»£", "CO2æ’å‡ºé‡ï¼ˆç©ºè·èµ°è¡Œï¼‰", "ãƒˆãƒ©ãƒƒã‚¯ã®è£½é€ è²»", "äººä»¶è²»"], "e": "å…±åŒå›åã«ã‚ˆã‚Šã€ãƒˆãƒ©ãƒƒã‚¯ã®ç©ºè·èµ°è¡Œã‚’æ¸›ã‚‰ã—ã¾ã™ã€‚"},
    {"c": "äº‹æ¥­", "q": "UPRã®äº‹æ¥­ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã§ã€Œã‚³ãƒã‚¯ãƒ†ã‚£ãƒƒãƒ‰äº‹æ¥­ã€ã«å«ã¾ã‚Œã‚‹ã®ã¯ï¼Ÿ", "a": "ã‚«ãƒ¼ã‚·ã‚§ã‚¢ãƒªãƒ³ã‚°", "o": ["ãƒ‘ãƒ¬ãƒƒãƒˆãƒ¬ãƒ³ã‚¿ãƒ«", "ã‚«ãƒ¼ã‚·ã‚§ã‚¢ãƒªãƒ³ã‚°", "å€‰åº«è³ƒè²¸", "ãƒˆãƒ©ãƒƒã‚¯é‹é€"], "e": "ICTã‚„ãƒ“ãƒ¼ã‚¯ãƒ«ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ãŒå«ã¾ã‚Œã¾ã™ã€‚"},
    {"c": "äº‹æ¥­", "q": "UPRãŒæ‰±ã†æ¨™æº–ãƒ‘ãƒ¬ãƒƒãƒˆã®ã‚µã‚¤ã‚ºã¯ï¼Ÿ", "a": "1100Ã—1100mm", "o": ["1200Ã—800mm", "1100Ã—1100mm", "1000Ã—1200mm", "900Ã—900mm"], "e": "æ—¥æœ¬å›½å†…ã§æœ€ã‚‚ä¸€èˆ¬çš„ãªT11å‹ã§ã™ã€‚"},
    {"c": "äº‹æ¥­", "q": "ç‰©æµæ¥­ç•Œã®ã€Œ2024å¹´å•é¡Œã€ã«å¯¾ã™ã‚‹UPRã®ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã¯ï¼Ÿ", "a": "DXã«ã‚ˆã‚‹æ¥­å‹™åŠ¹ç‡åŒ–", "o": ["ãƒˆãƒ©ãƒƒã‚¯ã®å¢—ç”£", "DXã«ã‚ˆã‚‹æ¥­å‹™åŠ¹ç‡åŒ–", "ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã®çµ¦ä¸å‰Šæ¸›", "é«˜é€Ÿé“è·¯ã®ç„¡æ–™åŒ–"], "e": "ãƒ‘ãƒ¬ãƒƒãƒˆè¼¸é€ã‚„IoTæ´»ç”¨ã§å¾…æ©Ÿæ™‚é–“å‰Šæ¸›ãªã©ã«è²¢çŒ®ã—ã¾ã™ã€‚"},
    {"c": "IR", "q": "UPRã®æ ªä¸»ç·ä¼šã¯é€šå¸¸ä½•æœˆã«é–‹å‚¬ã•ã‚Œã‚‹ï¼Ÿ", "a": "11æœˆ", "o": ["8æœˆ", "11æœˆ", "1æœˆ", "5æœˆ"], "e": "8æœˆæ±ºç®—ã®ãŸã‚ã€é€šå¸¸11æœˆã«é–‹å‚¬ã•ã‚Œã¾ã™ã€‚"},
    {"c": "ç”¨èª", "q": "RFIDã¨ã¯ä½•ã®ç•¥ï¼Ÿ", "a": "Radio Frequency Identification", "o": ["Remote Frequency ID", "Radio Frequency Identification", "Real Fast ID", "Robot Factory ID"], "e": "ç„¡ç·šé€šä¿¡ã«ã‚ˆã‚‹è‡ªå‹•èªè­˜æŠ€è¡“ã§ã™ã€‚"},

    # --- ãƒãƒ‹ã‚¢ãƒƒã‚¯ãƒ»è©³ç´° ---
    {"c": "è©³ç´°", "q": "UPRã®Webã‚µã‚¤ãƒˆãƒ‰ãƒ¡ã‚¤ãƒ³ã¯ï¼Ÿ", "a": "upr-net.co.jp", "o": ["upr.co.jp", "upr-net.co.jp", "upr-group.com", "upr-logi.jp"], "e": "å…¬å¼ã‚µã‚¤ãƒˆã¯ upr-net.co.jp ã§ã™ã€‚"},
    {"c": "è©³ç´°", "q": "UPRã®ãƒ¬ãƒ³ã‚¿ãƒ«ãƒ‘ãƒ¬ãƒƒãƒˆã®ä¸»ãªæè³ªã¯ï¼Ÿ", "a": "ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯", "o": ["æœ¨æ", "é‡‘å±", "ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯", "ç´™"], "e": "è€ä¹…æ€§ã¨è¡›ç”Ÿé¢ã«å„ªã‚ŒãŸãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯è£½ãŒä¸»åŠ›ã§ã™ã€‚"},
    {"c": "è©³ç´°", "q": "UPRã®ã‚¢ã‚·ã‚¹ãƒˆã‚¹ãƒ¼ãƒ„å±•é–‹å›½ã«å«ã¾ã‚Œã‚‹ã®ã¯ï¼Ÿ", "a": "å°æ¹¾", "o": ["ãƒ–ãƒ©ã‚¸ãƒ«", "å°æ¹¾", "ã‚±ãƒ‹ã‚¢", "å—æ¥µ"], "e": "å°æ¹¾ç­‰ã®ã‚¢ã‚¸ã‚¢åœ°åŸŸã§ã‚‚å±•é–‹ã—ã¦ã„ã¾ã™ã€‚"},
    {"c": "è©³ç´°", "q": "ã€Œãªã‚“ã¤ã„ã€ã®é€šä¿¡æ–¹å¼ã«å«ã¾ã‚Œã‚‹ã®ã¯ï¼Ÿ", "a": "GPS/LTE", "o": ["5Gã®ã¿", "GPS/LTE", "èµ¤å¤–ç·š", "éŸ³æ³¢"], "e": "åºƒåŸŸã§ã®è¿½è·¡ã«æºå¸¯é›»è©±ç¶²ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚"},
    {"c": "è©³ç´°", "q": "UPRã®äºŒæœ¬ç¤¾åˆ¶ã€æ±äº¬ã¨ã‚‚ã†ä¸€ã¤ã¯ï¼Ÿ", "a": "å±±å£çœŒå®‡éƒ¨å¸‚", "o": ["ç¦å²¡å¸‚", "å±±å£çœŒå®‡éƒ¨å¸‚", "åºƒå³¶å¸‚", "å¤§é˜ªå¸‚"], "e": "ç™»è¨˜ä¸Šã®æœ¬åº—ã‚‚å®‡éƒ¨å¸‚ã«ã‚ã‚Šã¾ã™ã€‚"},
    {"c": "è©³ç´°", "q": "UPRãŒæ”¯æ´ã™ã‚‹ã‚«ãƒ¼ã‚·ã‚§ã‚¢ã®åˆ©ç”¨ã‚·ãƒ¼ãƒ³ã¯ï¼Ÿ", "a": "ä¼æ¥­ã®ç¤¾ç”¨è»Šæ´»ç”¨", "o": ["å€‹äººé–“ã®è²¸ã—å€Ÿã‚Š", "ä¼æ¥­ã®ç¤¾ç”¨è»Šæ´»ç”¨", "ãƒ¬ãƒ¼ã‚¹ç”¨è»Šä¸¡", "è‡ªè»¢è»Šã‚·ã‚§ã‚¢"], "e": "éŠä¼‘è³‡ç”£ã®æœ‰åŠ¹æ´»ç”¨ã‚’ä¿ƒé€²ã—ã¾ã™ã€‚"},
    {"c": "è©³ç´°", "q": "UPRã®ã€Œã‚¢ã‚¯ãƒ†ã‚£ãƒ–RFIDã€ã®ç‰¹å¾´ã¯ï¼Ÿ", "a": "é›»æ± å†…è”µã§é€šä¿¡è·é›¢ãŒé•·ã„", "o": ["é›»æ± ä¸è¦", "é€šä¿¡è·é›¢ãŒæ•°ãƒŸãƒª", "é›»æ± å†…è”µã§é€šä¿¡è·é›¢ãŒé•·ã„", "æ°´ä¸­å°‚ç”¨"], "e": "è‡ªã‚‰é›»æ³¢ã‚’ç™ºã™ã‚‹ãŸã‚ã€åºƒç¯„å›²ã§ã®æ¤œçŸ¥ãŒå¯èƒ½ã§ã™ã€‚"},
    {"c": "è©³ç´°", "q": "UPRã®ãƒ‘ãƒ¬ãƒƒãƒˆãƒ¬ãƒ³ã‚¿ãƒ«ã®å¥‘ç´„å½¢æ…‹ã®ç‰¹å¾´ã¯ï¼Ÿ", "a": "å¿…è¦ãªæ™‚ã«å¿…è¦ãªæšæ•°ã ã‘", "o": ["å¿…ãš3å¹´å¥‘ç´„", "è²·å–å¿…é ˆ", "å¿…è¦ãªæ™‚ã«å¿…è¦ãªæšæ•°ã ã‘", "æœ€ä½1ä¸‡æšã‹ã‚‰"], "e": "æ³¢å‹•å¯¾å¿œãŒã—ã‚„ã™ã„æŸ”è»Ÿãªãƒ¬ãƒ³ã‚¿ãƒ«æ–¹å¼ã§ã™ã€‚"},
    {"c": "è©³ç´°", "q": "UPRã®ãƒ‘ãƒ¬ãƒƒãƒˆã®è‰²ã¨ã—ã¦ä¸€èˆ¬çš„ãªã®ã¯ï¼Ÿ", "a": "é»’ã‚„æ·±ç·‘ãªã©ã®æ¿ƒè‰²", "o": ["ç™½", "ãƒ”ãƒ³ã‚¯", "é€æ˜", "é»’ã‚„æ·±ç·‘ãªã©ã®æ¿ƒè‰²"], "e": "å†ç”Ÿæã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒå¤šãã€æ±šã‚Œã‚‚ç›®ç«‹ã¡ã«ãã„è‰²ãŒæ¡ç”¨ã•ã‚Œã¾ã™ã€‚"},
    {"c": "è©³ç´°", "q": "UPRã®é€£çµå¾“æ¥­å“¡æ•°è¦æ¨¡ã¯ï¼Ÿï¼ˆ2024å¹´ï¼‰", "a": "200åå°", "o": ["50åä»¥ä¸‹", "200åå°", "1000åä»¥ä¸Š", "1ä¸‡åä»¥ä¸Š"], "e": "å°‘æ•°ç²¾é‹­ã§é«˜åç›Šãªäº‹æ¥­ã‚’å±•é–‹ã—ã¦ã„ã¾ã™ã€‚"},
]

# --- 2. å•é¡Œç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ï¼ˆ300å•ã¸ã®æ‹¡å¼µï¼‰ ---
# åŸºæœ¬å•é¡Œã‚’åŠ å·¥ã—ã¦ã€ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³å•é¡Œã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™ã€‚

def generate_questions(base_list):
    """åŸºæœ¬ãƒªã‚¹ãƒˆã‹ã‚‰300å•ä»¥ä¸Šã®ã‚¹ãƒˆãƒƒã‚¯ã‚’ç”Ÿæˆã™ã‚‹"""
    extended_list = []
    
    # 1. åŸºæœ¬å•é¡Œã‚’ãã®ã¾ã¾è¿½åŠ 
    for item in base_list:
        extended_list.append({
            "category": item["c"],
            "question": item["q"],
            "answer": item["a"],
            "options": item["o"],
            "explanation": item["e"]
        })
    
    # 2. ã€é€†å¼•ãå•é¡Œã€‘ã‚’ä½œæˆï¼ˆç­”ãˆã‹ã‚‰è³ªå•ã‚’å½“ã¦ã‚‹ï¼‰
    # ä¾‹: ã€Œé…’ç”° ç¾©çŸ¢ã€ãŒç­”ãˆã«ãªã‚‹å•é¡Œ
    for item in base_list:
        # é¸æŠè‚¢ã®ä¸­ã«æ­£è§£ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªï¼ˆå¿µã®ãŸã‚ï¼‰
        if item["a"] in item["o"]:
            new_q = f"æ¬¡ã®ã†ã¡ã€ã€Œ{item['a']}ã€ãŒæ­£è§£ã¨ãªã‚‹è³ªå•ã¯ã©ã‚Œï¼Ÿ"
            
            # èª¤ç­”ã®é¸æŠè‚¢ã‚’ä½œæˆï¼ˆä»–ã®å•é¡Œã®è³ªå•æ–‡ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«æŒã£ã¦ãã‚‹ï¼‰
            wrong_questions = [
                x["q"] for x in base_list 
                if x["q"] != item["q"] and x["a"] != item["a"]
            ]
            if len(wrong_questions) >= 3:
                opts = random.sample(wrong_questions, 3) + [item["q"]]
                random.shuffle(opts)
                
                extended_list.append({
                    "category": f"{item['c']}ï¼ˆé€†å¼•ï¼‰",
                    "question": new_q,
                    "answer": item["q"],
                    "options": opts,
                    "explanation": f"ã€Œ{item['q']}ã€ã®ç­”ãˆãŒã€Œ{item['a']}ã€ã§ã™ã€‚"
                })

    # 3. ã€True/Falseå•é¡Œã€‘ã‚’ä½œæˆ
    for item in base_list:
        # æ­£ã—ã„æ–‡ã‚’ä½œæˆ
        is_true_case = random.choice([True, False])
        
        if is_true_case:
            q_text = f"UPRã«é–¢ã™ã‚‹è¨˜è¿°ã¨ã—ã¦æ­£ã—ã„ã‹ï¼Ÿ\nã€Œ{item['q']}ã®ç­”ãˆã¯ã€{item['a']}ã€ã§ã‚ã‚‹ã€‚ã€"
            ans = "æ­£ã—ã„"
            expl = item["e"]
        else:
            # é–“é•ã„ã®é¸æŠè‚¢ã‚’å–å¾—
            wrong_answers = [x for x in item["o"] if x != item["a"]]
            if not wrong_answers: continue
            fake_ans = random.choice(wrong_answers)
            q_text = f"UPRã«é–¢ã™ã‚‹è¨˜è¿°ã¨ã—ã¦æ­£ã—ã„ã‹ï¼Ÿ\nã€Œ{item['q']}ã®ç­”ãˆã¯ã€{fake_ans}ã€ã§ã‚ã‚‹ã€‚ã€"
            ans = "èª¤ã‚Š"
            expl = f"æ­£ã—ãã¯ã€Œ{item['a']}ã€ã§ã™ã€‚\n{item['e']}"
        
        extended_list.append({
            "category": f"{item['c']}ï¼ˆæ­£èª¤ï¼‰",
            "question": q_text,
            "answer": ans,
            "options": ["æ­£ã—ã„", "èª¤ã‚Š"],
            "explanation": expl
        })

    # 4. ã€ç©´åŸ‹ã‚å•é¡Œã€‘ã‚’ä½œæˆï¼ˆã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’éš ã™ï¼‰
    for item in base_list:
        if "UPR" in item["q"]:
            # è³ªå•æ–‡ã® "UPR" ã‚’ "???" ã«å¤‰ãˆã¦ä¼æ¥­åã‚’å•ã†ãƒ¡ã‚¿å•é¡Œ
            q_text = item["q"].replace("UPR", "å½“ç¤¾")
            extended_list.append({
                "category": "ç¤¾åã‚¯ã‚¤ã‚º",
                "question": f"æ¬¡ã®è³ªå•ã¯ã€ã‚ã‚‹ä¼æ¥­ã«é–¢ã™ã‚‹ã‚‚ã®ã§ã™ã€‚\nã€{q_text}ã€\nã“ã®ä¼æ¥­ã®åç§°ã¯ï¼Ÿ",
                "answer": "UPR",
                "options": ["JPR", "UPR", "MPR", "GPR"],
                "explanation": "ã‚‚ã¡ã‚ã‚“ã€UPRæ ªå¼ä¼šç¤¾ã®ã“ã¨ã§ã™ï¼"
            })

    return extended_list

# ã‚¹ãƒˆãƒƒã‚¯ã®ç”Ÿæˆï¼ˆå®Ÿè¡Œæ™‚ã«ç”Ÿæˆã•ã‚Œã‚‹ãŸã‚ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ãŒè‰¯ã„ï¼‰
ALL_QUESTIONS = generate_questions(BASE_QUESTIONS)

# 1å›ã®ã‚¯ã‚¤ã‚ºã®å•é¡Œæ•°
NUM_QUESTIONS_PER_QUIZ = 10 

# --- 3. Streamlit ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç† ---

def init_game():
    """ã‚²ãƒ¼ãƒ ã®åˆæœŸåŒ–å‡¦ç†"""
    st.session_state["score"] = 0
    st.session_state["current_q_index"] = 0
    st.session_state["finished"] = False
    st.session_state["answered"] = False 
    st.session_state["user_choice"] = None
    
    # å…¨ã‚¹ãƒˆãƒƒã‚¯ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«10å•æŠ½å‡º
    # ã‚¹ãƒˆãƒƒã‚¯æ•°ã‚’ç¢ºèª
    stock_len = len(ALL_QUESTIONS)
    quiz_size = min(stock_len, NUM_QUESTIONS_PER_QUIZ)
    
    st.session_state["questions"] = random.sample(ALL_QUESTIONS, quiz_size)
    st.session_state["total_stock"] = stock_len # ãƒ‡ãƒãƒƒã‚°ç”¨ã«ã‚¹ãƒˆãƒƒã‚¯æ•°ã‚’ä¿å­˜

if "questions" not in st.session_state:
    init_game()

# --- 4. UI/ãƒ‡ã‚¶ã‚¤ãƒ³ ---

with st.sidebar:
    # UPRãƒ­ã‚´ï¼ˆã‚¤ãƒ¡ãƒ¼ã‚¸ï¼‰ã¨ã‚¿ã‚¤ãƒˆãƒ«
    st.markdown("## ğŸšš UPRã‚¯ã‚¤ã‚ºã‚¢ãƒ—ãƒª")
    st.caption(f"åéŒ²å•é¡Œã‚¹ãƒˆãƒƒã‚¯: {len(ALL_QUESTIONS)} å•")
    
    if not st.session_state["finished"]:
        current = st.session_state["current_q_index"]
        total = len(st.session_state["questions"])
        
        st.subheader(f"Q. {current + 1} / {total}")
        st.progress((current) / total if total > 0 else 0)
        st.metric("SCORE", f"{st.session_state['score']} ç‚¹")
        
    if st.button("ğŸ”„ æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™", key="restart_btn"):
        init_game()
        st.rerun()

# --- 5. ãƒ¡ã‚¤ãƒ³ç”»é¢ ---

if st.session_state["finished"]:
    st.balloons()
    score = st.session_state["score"]
    total = len(st.session_state["questions"])
    
    st.markdown("<h1 style='color:#004098;'>çµæœç™ºè¡¨ï¼</h1>", unsafe_allow_html=True)
    st.markdown(f"### ã‚ãªãŸã®ã‚¹ã‚³ã‚¢: **{score} / {total}**")
    
    if score == total:
        st.success("ğŸ† ãƒ‘ãƒ¼ãƒ•ã‚§ã‚¯ãƒˆï¼ ã‚ãªãŸã“ãçœŸã®UPRãƒã‚¹ã‚¿ãƒ¼ã§ã™ï¼")
    elif score >= total * 0.7:
        st.info("ğŸ‘ ãŠè¦‹äº‹ï¼ UPRã«ã¤ã„ã¦ã‹ãªã‚Šè©³ã—ã„ã§ã™ã­ã€‚")
    else:
        st.warning("ğŸ’ª ã¾ã ã¾ã ä¼¸ã³ä»£ãŒã‚ã‚Šã¾ã™ï¼ ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã—ã¾ã—ã‚‡ã†ã€‚")
    
    st.markdown("---")
    if st.button("ğŸ”¥ æ–°ã—ã„å•é¡Œã«æŒ‘æˆ¦ã™ã‚‹", use_container_width=True):
        init_game()
        st.rerun()

else:
    # å•é¡Œè¡¨ç¤º
    idx = st.session_state["current_q_index"]
    q_data = st.session_state["questions"][idx]
    
    # ã‚«ãƒ†ã‚´ãƒªãƒãƒƒã‚¸
    st.markdown(f"<span style='background-color:#004098; color:white; padding:4px 8px; border-radius:4px; font-size:0.8em;'>{q_data['category']}</span>", unsafe_allow_html=True)
    st.markdown(f"### Q{idx + 1}. {q_data['question']}")
    
    st.markdown("---")

    # é¸æŠè‚¢ãƒœã‚¿ãƒ³
    choices_container = st.container()
    with choices_container:
        # é¸æŠè‚¢ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆã‚¹ãƒãƒ›å¯¾å¿œï¼š2åˆ—ã¾ãŸã¯1åˆ—ï¼‰
        cols = st.columns(1) # ã‚¹ãƒãƒ›ã§è¦‹ã‚„ã™ã„ã‚ˆã†ã«1åˆ—ã«å¤‰æ›´ï¼ˆé¸æŠè‚¢ãŒé•·æ–‡ã®å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ï¼‰
        
        for i, option in enumerate(q_data["options"]):
            # å›ç­”æ¸ˆã¿ã‹ã©ã†ã‹ã§ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’å¤‰ãˆã‚‹
            if not st.session_state["answered"]:
                if st.button(option, key=f"opt_{idx}_{i}", use_container_width=True):
                    # æ­£è§£åˆ¤å®šã¨ã‚¹ã‚³ã‚¢åŠ ç®—
                    is_correct = (option == q_data["answer"])
                    if is_correct:
                        st.session_state["score"] += 1
                    
                    st.session_state["user_choice"] = option
                    st.session_state["answered"] = True
                    st.rerun()
            else:
                # å›ç­”å¾Œã¯ãƒœã‚¿ãƒ³ç„¡åŠ¹åŒ–ï¼ˆé¸ã‚“ã ã‚‚ã®ã¯è‰²ã‚’å¤‰ãˆãŸã„ãŒã€æ¨™æº–ãƒœã‚¿ãƒ³ã§ã¯é™ç•ŒãŒã‚ã‚‹ã®ã§ç„¡åŠ¹åŒ–ã®ã¿ï¼‰
                st.button(option, key=f"opt_{idx}_{i}", use_container_width=True, disabled=True)

    # å›ç­”å¾Œã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
    if st.session_state["answered"]:
        st.markdown("---")
        user_choice = st.session_state["user_choice"]
        
        if user_choice == q_data["answer"]:
            st.success(f"â­• æ­£è§£ï¼")
        else:
            st.error(f"âŒ ä¸æ­£è§£... ï¼ˆå›ç­”: {user_choice}ï¼‰")
            
        st.markdown(f"##### æ­£è§£: **{q_data['answer']}**")
        st.info(f"ğŸ’¡ **è§£èª¬:**\n{q_data['explanation']}")
        
        st.markdown("<br>", unsafe_allow_html=True)
        
        # æ¬¡ã¸ãƒœã‚¿ãƒ³
        if idx + 1 >= len(st.session_state["questions"]):
            if st.button("çµæœã‚’è¦‹ã‚‹ â¡ï¸", type="primary", use_container_width=True):
                st.session_state["finished"] = True
                st.rerun()
        else:
            if st.button("æ¬¡ã®å•é¡Œã¸ â¡ï¸", type="primary", use_container_width=True):
                st.session_state["current_q_index"] += 1
                st.session_state["answered"] = False
                st.session_state["user_choice"] = None
                st.rerun()